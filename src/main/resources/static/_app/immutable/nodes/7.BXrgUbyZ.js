import{t as m,a as y,b as It}from"../chunks/DyJux5AM.js";import"../chunks/TPdjuWMd.js";import{a7 as lt,p as Mt,t as P,c as l,a as qt,s as i,a2 as _,a8 as st,r as d,g as n,f as nt}from"../chunks/CZkFhCqJ.js";import{l as Ot,e as h,s as g}from"../chunks/Df5S150I.js";import{s as J,a as Tt,c as I,i as it,b as ct}from"../chunks/BW_ZcXfj.js";import{e as R,i as U}from"../chunks/D27sE8o2.js";import{b as V,r as W}from"../chunks/Bf81OFe9.js";import{i as Dt}from"../chunks/B5VKFBCM.js";import{i as Et}from"../chunks/BaMhqmz6.js";import{o as Ct}from"../chunks/D9-DIcJb.js";import{w as M}from"../chunks/DcV-m7ys.js";function ut(r,v,c){if(r.multiple)return Jt(r,v);for(var b of r.options){var a=q(b);if(Dt(a,v)){b.selected=!0;return}}(!c||v!==void 0)&&(r.selectedIndex=-1)}function At(r,v){lt(()=>{var c=new MutationObserver(()=>{var b=r.__value;ut(r,b)});return c.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{c.disconnect()}})}function dt(r,v,c=v){var b=!0;Ot(r,"change",a=>{var p=a?"[selected]":":checked",w;if(r.multiple)w=[].map.call(r.querySelectorAll(p),q);else{var O=r.querySelector(p)??r.querySelector("option:not([disabled])");w=O&&q(O)}c(w)}),lt(()=>{var a=v();if(ut(r,a,b),b&&a===void 0){var p=r.querySelector(":checked");p!==null&&(a=q(p),c(a))}r.__value=a,b=!1}),At(r)}function Jt(r,v){for(var c of r.options)c.selected=~v.indexOf(q(c))}function q(r){return"__value"in r?r.__value:r.value}var Lt=m("<option> </option>"),Nt=m("<option> </option>"),Bt=m('<input type="number" class="border px-2 py-1 rounded w-20">'),Ft=m('<button class="bg-gray-200 px-3 py-1 text-white rounded hover:bg-gray-400 mr-2">저장</button> <button class="bg-gray-200 px-3 py-1 text-white rounded hover:bg-gray-400">취소</button>',1),Ht=m('<button class="bg-gray-200 px-3 py-1 text-white rounded hover:bg-gray-400 mr-2">수정</button> <button class="bg-gray-200 px-3 py-1 text-white rounded hover:bg-gray-400">삭제</button>',1),Kt=m('<tr class="border-b"><td class="border px-4 py-3 text-center"> </td><td class="border px-4 py-3 text-center"> </td><td class="border px-4 py-3 text-center"> </td><td class="border px-4 py-3 text-center"> </td><td class="border px-4 py-3 text-center"><!></td><td class="border px-4 py-3 text-center"><!></td></tr>'),zt=m('<main class="flex flex-col items-center justify-center min-h-screen bg-gray-50 p-8 gap-4"><button class="absolute top-4 left-4 px-4 py-2 bg-gray-200 text-white rounded hover:bg-gray-400 transition">← 뒤로가기</button> <h1 class="text-3xl font-bold mb-6">상품 관리</h1> <div class="mb-6 flex flex-wrap gap-4"><select class="border px-4 py-2 rounded"><option>브랜드 선택</option><!></select> <input type="text" placeholder="상품명" class="border px-4 py-2 rounded"> <select class="border px-4 py-2 rounded"><option>카테고리 선택</option><!></select> <input type="number" placeholder="가격" class="border px-4 py-2 rounded w-28"> <button class="bg-gray-200 px-4 py-2 text-white rounded hover:bg-gray-400 transition">추가</button></div> <table class="w-full max-w-4xl bg-white shadow-md rounded-lg"><thead class="bg-gray-200"><tr><th class="px-4 py-3 border">ID</th><th class="px-4 py-3 border">브랜드 ID</th><th class="px-4 py-3 border">상품명</th><th class="px-4 py-3 border">카테고리</th><th class="px-4 py-3 border">가격</th><th class="px-4 py-3 border">액션</th></tr></thead><tbody></tbody></table></main>');function re(r,v){Mt(v,!1);const[c,b]=Tt(),a=()=>J(k,"$newProduct",c),p=()=>J(S,"$editingProduct",c),w=()=>J(Y,"$brands",c),O=()=>J(X,"$products",c),X=M([]),Y=M([]),pt=["상의","아우터","바지","스니커즈","가방","모자","양말","액세서리"],k=M({brandId:"",name:"",category:"",price:""}),S=M(null),$=M(null),vt=async()=>{try{const t=await(await fetch("http://localhost:8080/api/v1/brands")).json();if(t.isSucceeded&&Y.set(t.result),!t.isSucceeded){alert(t.errorMessage);return}}catch{$.set("브랜드 정보를 불러오는데 실패했습니다.")}},T=async()=>{try{const t=await(await fetch("http://localhost:8080/api/v1/products")).json();if(t.isSucceeded)X.set(t.result);else{alert(t.errorMessage);return}}catch{$.set("상품 정보를 불러오는데 실패했습니다.")}},Z=async()=>{try{const t=await(await fetch("http://localhost:8080/api/v1/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a())})).json();if(!t.isSucceeded){alert(t.errorMessage);return}k.set({brandId:"",name:"",category:"",price:""}),T()}catch{$.set("상품 추가에 실패했습니다.")}},bt=async()=>{try{const e=p(),o=await(await fetch(`http://localhost:8080/api/v1/products/${e.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({price:e.price})})).json();if(!o.isSucceeded){alert(o.errorMessage);return}S.set(null),T()}catch{$.set("상품 수정에 실패했습니다.")}},_t=async e=>{try{const t=await fetch(`http://localhost:8080/api/v1/products/${e}`,{method:"DELETE"});T();const o=await t.json();if(!o.isSucceeded){alert(o.errorMessage);return}}catch{$.set("상품 삭제에 실패했습니다.")}};function tt(e){e.key==="Enter"&&Z()}Ct(()=>{vt(),T()}),Et();var L=zt(),et=l(L),N=i(et,4),D=l(N);P(()=>{a(),st(()=>{w()})});var B=l(D);B.value=((B.__value="")==null,"");var ft=i(B);R(ft,1,w,U,(e,t)=>{var o=Lt(),f={},j=l(o,!0);d(o),P(()=>{f!==(f=n(t).id)&&(o.value=(o.__value=n(t).id)==null?"":n(t).id),g(j,n(t).name)}),y(e,o)}),d(D);var E=i(D,2);W(E);var C=i(E,2);P(()=>{a(),st(()=>{})});var F=l(C);F.value=((F.__value="")==null,"");var yt=i(F);R(yt,1,()=>pt,U,(e,t)=>{var o=Nt(),f={},j=l(o,!0);d(o),P(()=>{f!==(f=n(t))&&(o.value=(o.__value=n(t))==null?"":n(t)),g(j,n(t))}),y(e,o)}),d(C);var A=i(C,2);W(A);var ht=i(A,2);d(N);var rt=i(N,2),at=i(l(rt));R(at,5,O,U,(e,t)=>{var o=Kt(),f=l(o),j=l(f,!0);d(f);var H=i(f),xt=l(H,!0);d(H);var K=i(H),gt=l(K,!0);d(K);var z=i(K),mt=l(z,!0);d(z);var G=i(z),wt=l(G);{var kt=u=>{var s=Bt();W(s),V(s,()=>p().price,x=>I(S,_(p).price=x,_(p))),y(u,s)},Pt=u=>{var s=It();P(()=>g(s,`${n(t).price??""}원`)),y(u,s)};it(wt,u=>{var s;((s=p())==null?void 0:s.id)===n(t).id?u(kt):u(Pt,!1)})}d(G);var ot=i(G),St=l(ot);{var $t=u=>{var s=Ft(),x=nt(s),Q=i(x,2);h("click",x,bt),h("click",Q,()=>ct(S,null)),y(u,s)},jt=u=>{var s=Ht(),x=nt(s),Q=i(x,2);h("click",x,()=>ct(S,{id:n(t).id,price:n(t).price})),h("click",Q,()=>_t(n(t).id)),y(u,s)};it(St,u=>{var s;((s=p())==null?void 0:s.id)===n(t).id?u($t):u(jt,!1)})}d(ot),d(o),P(()=>{g(j,n(t).id),g(xt,n(t).brandId),g(gt,n(t).name),g(mt,n(t).category)}),y(e,o)}),d(at),d(rt),d(L),h("click",et,()=>history.back()),dt(D,()=>a().brandId,e=>I(k,_(a).brandId=e,_(a))),V(E,()=>a().name,e=>I(k,_(a).name=e,_(a))),h("keydown",E,tt),dt(C,()=>a().category,e=>I(k,_(a).category=e,_(a))),V(A,()=>a().price,e=>I(k,_(a).price=e,_(a))),h("keydown",A,tt),h("click",ht,Z),y(r,L),qt(),b()}export{re as component};
